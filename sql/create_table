CREATE TABLE "public.Movies" (
	"id" serial NOT NULL,
	"name" VARCHAR(255) NOT NULL,
	"release_date" DATE NOT NULL,
	"duration" TIME NOT NULL,
	"mpaa" VARCHAR(255),
	"rating" FLOAT,
	"genre" VARCHAR(255) NOT NULL,
	CONSTRAINT "Movies_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "public.Cinemas" (
	"id" serial NOT NULL,
	"name" VARCHAR(255) NOT NULL,
	"location" VARCHAR(255),
	CONSTRAINT "Cinemas_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "public.Halls" (
	"id" serial NOT NULL,
	"name" VARCHAR(255) NOT NULL,
	"cinema_id" integer NOT NULL,
	"type" VARCHAR(255),
	CONSTRAINT "Halls_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "public.Seats" (
	"id" serial NOT NULL,
	"row" integer NOT NULL,
	"place" integer NOT NULL,
	"hall_id" integer NOT NULL,
	CONSTRAINT "Seats_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "public.Customer" (
	"id" serial NOT NULL,
	"name" VARCHAR(255),
	"birthday" DATE,
	"avatar" VARCHAR(255) NOT NULL,
	CONSTRAINT "Customer_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "public.Sessions" (
	"id" serial NOT NULL,
	"movie_id" integer NOT NULL,
	"hall_id" integer NOT NULL,
	"time" TIMESTAMP NOT NULL,
	CONSTRAINT "Sessions_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "public.Tickets" (
	"id" serial NOT NULL,
	"customer_id" integer NOT NULL,
	"seat_id" integer NOT NULL,
	"session_id" integer NOT NULL,
	"payment_time" TIMESTAMP NOT NULL,
	"price" integer NOT NULL,
	"isBought" BOOLEAN NOT NULL DEFAULT 'FALSE',
	CONSTRAINT "Tickets_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "public.films_crew" (
	"id" serial NOT NULL,
	"movie_id" integer NOT NULL,
	"member_id" integer NOT NULL,
	"position" VARCHAR(255),
	CONSTRAINT "films_crew_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "public.film_crew_member" (
	"id" serial NOT NULL,
	"name" VARCHAR(255) NOT NULL,
	CONSTRAINT "film_crew_member_pk" PRIMARY KEY ("id")
) WITH (
  OIDS=FALSE
);



CREATE TABLE "public.genres" (
	"name" VARCHAR(255) NOT NULL UNIQUE,
	CONSTRAINT "genres_pk" PRIMARY KEY ("name")
) WITH (
  OIDS=FALSE
);



ALTER TABLE "Movies" ADD CONSTRAINT "Movies_fk0" FOREIGN KEY ("mpaa") REFERENCES "undefined"("undefined");
ALTER TABLE "Movies" ADD CONSTRAINT "Movies_fk1" FOREIGN KEY ("genre") REFERENCES "genres"("name");


ALTER TABLE "Halls" ADD CONSTRAINT "Halls_fk0" FOREIGN KEY ("cinema_id") REFERENCES "Cinemas"("id");

ALTER TABLE "Seats" ADD CONSTRAINT "Seats_fk0" FOREIGN KEY ("hall_id") REFERENCES "Halls"("id");


ALTER TABLE "Sessions" ADD CONSTRAINT "Sessions_fk0" FOREIGN KEY ("movie_id") REFERENCES "Movies"("id");
ALTER TABLE "Sessions" ADD CONSTRAINT "Sessions_fk1" FOREIGN KEY ("hall_id") REFERENCES "Halls"("id");

ALTER TABLE "Tickets" ADD CONSTRAINT "Tickets_fk0" FOREIGN KEY ("customer_id") REFERENCES "Customer"("id");
ALTER TABLE "Tickets" ADD CONSTRAINT "Tickets_fk1" FOREIGN KEY ("seat_id") REFERENCES "Seats"("id");
ALTER TABLE "Tickets" ADD CONSTRAINT "Tickets_fk2" FOREIGN KEY ("session_id") REFERENCES "Sessions"("id");

ALTER TABLE "films_crew" ADD CONSTRAINT "films_crew_fk0" FOREIGN KEY ("movie_id") REFERENCES "Movies"("id");
ALTER TABLE "films_crew" ADD CONSTRAINT "films_crew_fk1" FOREIGN KEY ("member_id") REFERENCES "film_crew_member"("id");
ALTER TABLE "films_crew" ADD CONSTRAINT "films_crew_fk2" FOREIGN KEY ("position") REFERENCES "positions"("name");
